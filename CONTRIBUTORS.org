#+TITLE: Contributor Guide
#+AUTHOR: Throwaway Agent Lab
#+OPTIONS: toc:t num:nil

Welcome to the *Throwaway Agent Lab*! This project sits at the intersection of several interesting technologies. To contribute effectively, it helps to be familiar with our core toolstack.

* Core Technologies

** 1. Python (The Language)

We use *Python 3.11+*.

- **Dependency Management**: We use [[https://github.com/astral-sh/uv][uv]] for fast, reliable dependency management.
  #+BEGIN_SRC bash
  uv pip install -e ".[dev]"
  #+END_SRC
- **Type Checking**: We use [[https://mypy-lang.org/][mypy]] for static type checking.
- **Formatting**: We use [[https://github.com/psf/black][Black]] for code formatting.

** 2. Pyodide (The Runtime)

[[https://pyodide.org/][Pyodide]] is a port of CPython to WebAssembly/Emscripten. It is the heart of our sandboxing strategy.

*Key Concepts for Contributors:*
- **Sandboxing**: The Python code generated by agents runs inside Pyodide, not on the host machine.
- **Virtual File System (VFS)**: Pyodide sees a virtual filesystem. It cannot access your hard drive directly.
- **No Sockets**: Standard Python networking (sockets) does not work in Pyodide. All network requests must be routed through JavaScript bridges or specific APIs.

*Resources:*
- [[https://pyodide.org/en/stable/usage/quickstart.html][Pyodide Quickstart]]
- [[https://emscripten.org/docs/api_reference/Filesystem-API.html][Emscripten File System API]]

** 3. Jujitsu (The Version Control)

We use [[https://github.com/martinvonz/jj][Jujitsu (jj)]] as our version control system. It is a Git-compatible VCS that provides a powerful, user-friendly interface for managing commits.

*Why jj?*
- **Implicit Commits**: Your working copy is always a commit. No more "stash to switch branches."
- **Easy Rebasing**: Reordering and editing history is safe and easy.
- **Stacked Changes**: You can work on multiple dependent features easily.

*Cheatsheet:*
#+BEGIN_SRC bash
# Check status
jj status

# Create a new change (branch) off main
jj new main

# Give the current change a description (commit message)
jj describe -m "feat: add new sandbox feature"

# Create a new change on top of your current one (stacking)
jj new

# Push your changes to GitHub
jj git push
#+END_SRC

** 4. Emacs & Org Mode (The Documentation)

We use [[https://orgmode.org/][Org Mode]] extensively for documentation, planning, and literate programming.

- **Literate Ops**: Files like ~setup.org~ are executable. You can run the code blocks directly from Emacs.
- **Project Planning**: We track tasks and experiments in ~.org~ files (e.g., ~TODO.org~, ~EXPERIMENTS.org~).

If you are new to Emacs, you don't *have* to use it (Markdown is readable too), but it is highly recommended for the best experience with our documentation.

* Experiment Driven Development (EDD)

We follow a strict EDD policy. Before building major features, we validate them in the ~experiments/~ directory.

- **Policy**: [[file:docs/EXPERIMENT_DRIVEN_DEV.org][docs/EXPERIMENT_DRIVEN_DEV.org]]
- **Helper**: ~./experiments/new_experiment.sh <slug>~

* Development Workflow

1. **Setup Environment**:
   #+BEGIN_SRC bash
   ./setup.sh
   uv pip install -e ".[dev]"
   npm install
   #+END_SRC

2. **Run Tests**:
   #+BEGIN_SRC bash
   # Run Python unit tests
   PYTHONPATH=src pytest

   # Run Pyodide integration tests
   npm test
   #+END_SRC

3. **Submit Changes**:
   - Create a change with ~jj new main~.
   - Implement your feature.
   - Run tests.
   - ~jj git push~ to upload to GitHub.
   - Open a Pull Request (GitHub treats ~jj~ branches like normal Git branches).
